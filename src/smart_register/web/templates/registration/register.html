{% extends "base.html" %}{% load smart_register l10n static %}
{% block head %}
    <script src="{% static "jquery.formset.js" %}"></script>
{% endblock head %}

{% block body %}
    {{ form.media }}
    <div class="min-h-screen flex justify-center bg-gray-100">
        <div class="w-full lg:w-1/2">
            <div class="text-center mb-16">
                <h3
                        class="pt-8 text-indigo-600 text-4xl leading-normal font-extrabold tracking-tight text-gray-900"
                >
                    {{ dataset.name }}
                </h3>
            </div>
            <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4" method="post">
                {{ form.errors }}
                <form class="w-full" method="post">
                    {% csrf_token %} {% for field in form %}
                    <div class="mb-4">
                        <label
                                class="block uppercase tracking-wide text-gray-700 font-bold mb-2"
                                for="{{ field.auto_id }}"
                        >{{ field.label }}</label
                        >
                        {{ field }}
                    </div>
                {% endfor %} {% for name, formset in formsets.items %}
                    <div class="shadow-md rounded bg-gray-100 p-4">
                        <div class="w-full formset" data-fs="{{ name }}"
                             data-required="{{ formset.required }}" data-extra="{{ formset.extra }}">
                            <div>
                                <div>
                                    <div
                                            class="w-full mt-4 text-sm leading-7 text-gray-500 font-regular uppercase text-center title"
                                    >
                                        {{ name }}
                                    </div>
                                    <div class="managementForm">{{ formset.management_form }}</div>
                                </div>
                            </div>
                            <div>
                                <div class="w-100 forms form-container {{ name }}" id="{{ name }}">
                                    {% for frm in formset %}
                                        <div class="w-full" id="{{ frm.prefix }}-row">
                                            {{ frm }}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
                    <div class="submit-row">
                        <input
                                type="submit"
                                class="mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
                                value="Save"
                        />
                    </div>
                </form>
            </div>
            {% for name, formset in formsets.items %}
                <script type="form-template" id="{{ name }}-empty">
                    <div class="form w-full margin-2" data-index="__prefix__">
                        <h2># __prefix__ </h2>
                        {% escapescript %}{{ formset.empty_form.as_table }}{% endescapescript %}
                        <input type="button" data-fs="{{ name }}"
                               class="btn remove bg-white hover:bg-gray-100 text-red-400 font-semibold py-2 px-4 border border-red-400 rounded shadow"
                               value="Remove {{ name }}">
                    </div>
                </script>
            {% endfor %}

        </div>
    </div>
    {% for name, formset in formsets.items %}
        {{ formset.media }}
        <script>
            console.log(1111, "{{ formset.prefix }}", $("#{{ formset.prefix }}") );
        </script>
    {% endfor %}

    <script>
            $("#individuals").formset({
                {#formCssClass: "",#}
                prefix: "{{ formset.prefix }}",
                {#addCssClass: "mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",#}
                {#deleteCssClass: "mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",#}
                addText: 'Add Record',
                deleteText: 'Remove Record',
                added: function (row) {
                    $(row).find(".vDateField").each(function (i) {
                        console.log(111111, i);
                    });
                }
            });
        </script>

{% endblock body %}
